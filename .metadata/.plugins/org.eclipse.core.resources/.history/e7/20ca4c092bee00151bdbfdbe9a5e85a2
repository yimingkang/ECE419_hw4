import java.util.logging.Logger;

import org.apache.zookeeper.ZooKeeper;

public class Worker {
    public static String jobPath = "/Jobs";
    public static String workerPath = "/Workers";
    public static ZooKeeper zk;
	private static final Logger logger = Logger.getLogger(Worker.class.getName());
	
	public static void main(String[] args){
        if (args.length != 1) {
            System.out.println("Usage: java -classpath lib/zookeeper-3.3.2.jar:lib/log4j-1.2.15.jar:. A zkServer:clientPort");
            return;
        }

        ZkConnector zkc = new ZkConnector();
        
        try {
            zkc.connect(args[0]);
        } catch(Exception e) {
            logger.info("Zookeeper connect "+ e.getMessage());
        }

        zk = zkc.getZooKeeper();
        
        /* 1- Make connection to zookeeper (already done)
         * 2- Set a Watch for /Workers node to handle worker failure
         * 3- On worker failure => use setData() on worker's current task to signal that 
         * 	  we need to re-process this task
         * 4- Loop through all tasks and work on it if it needs to be done (use setData() with version
         *    number to achieve atomic operation similar to test-and-set)
         */
        
        // Set a watcher
        
	}

}
